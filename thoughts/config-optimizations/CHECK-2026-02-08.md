# Config Optimization Report - 2026-02-08 (v2)

## Current Version: 2.1.37 (latest stable)
## Last Checked: 2.1.37 (2026-02-08)

---

## Version Status

v2.1.37 is the latest release. No new versions since last check.

| Version | Date | Changes |
|---------|------|---------|
| v2.1.37 | Feb 07 | Fix: `/fast` not immediately available after `/extra-usage` |
| v2.1.36 | Feb 07 | Fast mode for Opus 4.6 |
| v2.1.34 | Feb 06 | Fix: agent teams crash, sandbox bypass bug |
| v2.1.33 | Feb 06 | TeammateIdle/TaskCompleted hooks, agent memory frontmatter, SubagentStart hook, tmux teammate sessions |
| v2.1.32 | Feb 05 | Opus 4.6, Agent Teams preview, auto memory, partial summarization |

---

## New Findings (this scan)

### 1. `SubagentStart` Hook Event (v2.1.33+) â€” NEW

**Status**: Not configured
**What**: Fires when a subagent is spawned via Task tool. Can inject `additionalContext` into the subagent's context.
**Matcher**: Agent type name (`Bash`, `Explore`, `Plan`, custom agent names)
**Use cases**:
- Inject project-specific rules into subagents
- Log subagent spawning for analytics
- Add security guidelines to specific agent types

**Config**:
```json
{
  "SubagentStart": [
    {
      "matcher": "*",
      "hooks": [{
        "type": "command",
        "command": "$HOME/.claude/hooks/subagent-start.sh"
      }]
    }
  ]
}
```

**Recommendation**: â­ï¸ Skip for now â€” SubagentStop already covers post-execution. SubagentStart could be useful for context injection but adds latency to every agent spawn. Revisit if subagent quality issues arise.

### 2. `attribution` Setting â€” CONFIRMED VALUE

**Status**: Not configured
**What**: Replaces deprecated `includeCoAuthoredBy`. Empty string = no attribution.
**Config**:
```json
{
  "attribution": {
    "commit": "",
    "pr": ""
  }
}
```
**Recommendation**: âœ… **Apply** â€” Safety net for direct `git commit` (outside `/dev commit`). Aligns with dev-workflow rule prohibiting Co-Authored-By. Zero risk, prevents accidental attribution.

### 3. `autoUpdatesChannel` Setting â€” DISCOVERED

**Status**: Not configured (defaults to `"latest"`)
**What**: `"stable"` = versions 1 week old (skips major regressions), `"latest"` = newest
**Recommendation**: â­ï¸ Skip â€” `"latest"` default is fine. We already handle version-specific issues via config-optimize checks.

### 4. `sandbox` Settings â€” COMPREHENSIVE OPTIONS

**Status**: Not configured
**What**: Full bash sandboxing with network restrictions, domain allowlists, Unix socket access, proxy support
**Key**: `sandbox.enabled: true` + `sandbox.autoAllowBashIfSandboxed: true` = auto-approve bash in sandbox
**Recommendation**: â­ï¸ Skip â€” Current permission workflow works well. Sandbox adds complexity without significant benefit for plugin development.

### 5. `permissions` Fine-grained Rules

**Status**: Not using explicit rules
**What**: `permissions.allow`, `permissions.ask`, `permissions.deny` with glob patterns
**Example**: `"deny": ["Read(./.env)", "Read(./secrets/**)"]`
**Recommendation**: â­ï¸ Skip â€” Current workflow handles permissions adequately.

### 6. CLAUDE.md `@import` Syntax

**Status**: Available but not used
**What**: CLAUDE.md files can import other files with `@path/to/file` syntax. Recursive (max 5 hops).
**Recommendation**: â­ï¸ Skip â€” Current rules/ directory structure works well.

### 7. Path-scoped Rules (`paths` frontmatter)

**Status**: Available but not used in most rules
**What**: Rules can have `paths: ["src/**/*.ts"]` frontmatter to only apply when Claude works with matching files.
**Recommendation**: â­ï¸ Skip for now â€” Most rules are universal. Could be useful for platform-specific rules in HouseSigma projects.

---

## Previously Reviewed (unchanged)

| Feature | Status | Recommendation |
|---------|--------|---------------|
| Fast Mode for Opus 4.6 | Available | Use `/fast` toggle per-session |
| `teammateMode` | Default `"auto"` | Skip â€” default is correct |
| `outputStyle` | Not used | Skip â€” default is optimal |
| `fileSuggestion` | Not used | Skip â€” default works well |
| `spinnerVerbs` | Not used | Skip â€” cosmetic only |
| `language` | Not configured | Skip â€” rules handle language |
| `alwaysThinkingEnabled` | Not configured | Skip â€” per-task control better |
| Agent `skills` preloading | Partially used | Evaluate per-agent |
| `PostToolUseFailure` hook | Not configured | Skip â€” PostToolUse covers needs |
| Async hooks (`"async": true`) | Not used | Skip â€” current hooks are fast |
| Prompt-based hooks | Not used | Skip â€” bash is faster |
| Agent-based hooks | Not used | Skip â€” too expensive |
| `CLAUDE_CODE_EFFORT_LEVEL` | Not configured | Skip â€” `/model` control better |

---

## Current Config Health Check

### Hook Coverage: 10/14 events

| Hook Event | Configured | Script |
|------------|-----------|--------|
| SessionStart | âœ… | session-start.sh + braintrust |
| SessionEnd | âœ… | braintrust |
| PreToolUse | âœ… | pre-tool-use.sh |
| PostToolUse | âœ… | post-tool-use.sh + braintrust |
| PostToolUseFailure | âŒ | â€” |
| PermissionRequest | âŒ | â€” |
| UserPromptSubmit | âœ… | skill-activation-prompt.sh + braintrust |
| Notification | âŒ | â€” |
| SubagentStart | âŒ | â€” |
| SubagentStop | âœ… | subagent-stop.sh |
| Stop | âœ… | braintrust |
| TeammateIdle | âœ… | teammate-idle.sh |
| TaskCompleted | âœ… | task-completed.sh |
| PreCompact | âœ… | pre-compact.sh |

**Missing 4**: PostToolUseFailure, PermissionRequest, Notification, SubagentStart â€” all optional, no immediate need.

### âœ… Well Configured
- Agent Teams experimental enabled
- 10/14 hook events configured (all critical ones)
- StatusLine configured with dev-flow
- Braintrust tracing integrated
- All plugins enabled
- MCP servers auto-approved
- Auto memory enabled (default)

### âš ï¸ Actionable Improvements

| # | Item | Impact | Effort | Priority |
|---|------|--------|--------|----------|
| 1 | Add `attribution` setting (empty commit/pr) | Medium | Low | **P2** |

### âŒ Not Needed
- Fast mode global (use `/fast`)
- SubagentStart hook (overhead > value)
- Sandbox (complexity > benefit)
- outputStyle / language / spinnerVerbs (cosmetic)
- Async hooks (current hooks are fast)

---

## Documentation Sources

### Official Docs (code.claude.com)

| Source | Status |
|--------|--------|
| GitHub Releases (v2.1.32-v2.1.37) | âœ… Fully reviewed |
| Official Docs - Settings | âœ… Full review (all keys) |
| Official Docs - Hooks Reference | âœ… Full review (14 events) |
| Official Docs - Memory | âœ… Full review (auto memory, imports, rules) |
| Official Docs - Agent Teams | âœ… Full review |
| Official Docs - Plugins Reference | âœ… Full review |
| Official Docs - Sub-agents | âœ… Full review |
| Official Docs - Skills | âœ… Full review |
| Official Docs - Output Styles | âœ… Full review |
| Official Docs - Fast Mode | âœ… Full review |

### Blog Posts (claude.com + anthropic.com)

| Post | URL | Key Takeaway |
|------|-----|-------------|
| Opus 4.6 Launch | [anthropic.com](https://www.anthropic.com/news/claude-opus-4-6) | `/effort` 4 levels (low/med/high/max), adaptive thinking, 1M context beta |
| Xcode + Agent SDK | [anthropic.com](https://www.anthropic.com/news/apple-xcode-claude-agent-sdk) | Xcode 26.3 native MCP integration, visual previews |
| Bun Acquisition | [anthropic.com](https://www.anthropic.com/news/anthropic-acquires-bun-as-claude-code-reaches-usd1b-milestone) | Native installer, performance improvements coming |
| C Compiler (16 agents) | [anthropic.com](https://www.anthropic.com/engineering/building-c-compiler) | File-based locking, subsample testing, agent specialization |
| Anthropic Teams Usage | [claude.com](https://claude.com/blog/how-anthropic-teams-use-claude-code) | CLAUDE.md for onboarding, debugging with stack traces |
| Claude Code Sandboxing | [anthropic.com](https://www.anthropic.com/engineering/claude-code-sandboxing) | 84% fewer permission prompts with sandbox |
| Hooks Configuration | [claude.com](https://claude.com/blog/how-to-configure-hooks) | Same 14 events as docs, no new hooks discovered |
| Skills Explained | [claude.com](https://claude.com/blog/skills-explained) | Progressive disclosure confirmed, no new frontmatter |
| Plugins Blog | [claude.com](https://claude.com/blog/claude-code-plugins) | Plugin structure confirmed, marketplace workflow |
| Building Agents + Skills | [claude.com](https://claude.com/blog/building-agents-with-skills-equipping-agents-for-specialized-work) | Skills + MCP synergy, three-layer architecture |

### Blog Insights Summary

**æ— æ–°é…ç½®å‘ç°**ã€‚Blog å†…å®¹ä¸å®˜æ–¹æ–‡æ¡£ä¸€è‡´ï¼Œæœªå‘ç° docs æœªè¦†ç›–çš„æ–°è®¾ç½®æˆ–åŠŸèƒ½ã€‚

ä¸»è¦æ”¶è·ï¼š
- Opus 4.6 çš„ `/effort` å‘½ä»¤æœ‰ 4 çº§ (low/med/high/max)ï¼Œdocs åªæåˆ° env var
- Sandbox å‡å°‘ 84% æƒé™æç¤ºï¼ˆä½†å¯¹ plugin å¼€å‘åœºæ™¯ overkillï¼‰
- C Compiler é¡¹ç›®ç”¨äº† file-based locking æ›¿ä»£ Task Managementï¼ˆä¸é€‚ç”¨äºæˆ‘ä»¬çš„åœºæ™¯ï¼‰
- Xcode 26.3 MCP é›†æˆï¼ˆios-swift-plugin å¯èƒ½éœ€è¦å…³æ³¨ï¼‰

---

## Rules Consistency Check

**æ‰«æ**: 18 ä¸ª rule æ–‡ä»¶ï¼ˆæ’é™¤ `.project-specific/`ï¼‰ï¼Œ153 å¯¹ç»„åˆäº¤å‰æ£€æŸ¥ã€‚

### å‘ç°å¹¶ä¿®å¤

| # | File A | File B | Conflict | Severity | Fix |
|---|--------|--------|----------|----------|-----|
| 1 | `agentic-coding.md` "restart before 15%" | `context-budget.md` 15% = ğŸŸ¢ healthy | Context é˜ˆå€¼ç›´æ¥çŸ›ç›¾ | **Medium** | âœ… ç»Ÿä¸€ä¸º context-budget é˜ˆå€¼ä½“ç³» |
| 2 | `context-budget.md` 70% = prepare compact | `continuity.md` 70% â†’ /clear | åŠ¨ä½œä¸ä¸€è‡´ | Low | âœ… continuity åŒºåˆ† 70% å‡†å¤‡ / 85% /clear |
| 3 | `scope-control.md` "åªæ”¹è¯·æ±‚çš„" | `agentic-coding.md` "capture discoveries" | è¾¹ç•Œæ¨¡ç³Š | Low | âœ… scope-control åŠ æ³¨: è®°å½• â‰  ä¿®æ”¹ |
| 4 | `compact-output.md` grep error | `failure-detection.md` 2>/dev/null warning | æªè¾æ··æ·† | Low | âœ… compact-output åŠ æ³¨: è¿‡æ»¤ â‰  éšè— |
| 5 | `context-budget.md` "pipe to head/tail" | `command-tools.md` "NOT head/tail" | åœºæ™¯ä¸æ¸… | Low | âœ… context-budget æ ‡æ³¨: ä»…é™å‘½ä»¤è¾“å‡º |

### ä¿®æ”¹çš„æ–‡ä»¶

| File | Change |
|------|--------|
| `~/.claude/rules/agentic-coding.md` | Effective Context Window: åˆ é™¤ "15% restart"ï¼Œå¯¹é½ context-budget é˜ˆå€¼ |
| `~/.claude/rules/continuity.md` | æ—¶æœº: 70% = æ›´æ–° ledgerï¼ˆå‡†å¤‡ï¼‰ï¼Œ85% = /clearï¼ˆç«‹å³ï¼‰ |
| `~/.claude/rules/scope-control.md` | æ ¸å¿ƒåŸåˆ™åŠ æ³¨: è®°å½•å‘ç°ä¸ç®—ä¿®æ”¹ |
| `~/.claude/rules/compact-output.md` | è§„åˆ™åŠ æ³¨: è¿‡æ»¤è¾“å‡º â‰  éšè—é”™è¯¯ |
| `~/.claude/rules/context-budget.md` | Bash è¡Œæ ‡æ³¨: ä»…é™å‘½ä»¤è¾“å‡ºæˆªæ–­ |

### Summary

âœ… 0 critical | âš ï¸ 1 medium (å·²ä¿®å¤) | â„¹ï¸ 4 low (å·²ä¿®å¤)

---

## Summary

**é…ç½®éå¸¸å®Œå–„**ã€‚v2.1.37 æ˜¯æœ€æ–°ç‰ˆï¼Œæ— æ–°ç‰ˆæœ¬ã€‚

å·²æ£€æŸ¥å…¨éƒ¨æ¥æºï¼šGitHub Releases + å®˜æ–¹æ–‡æ¡£ (10 pages) + Blog (10 posts)ã€‚

å·²åº”ç”¨ï¼š
1. `attribution` è®¾ç½®ï¼ˆç©ºå€¼ï¼‰ï¼Œé˜²æ­¢ç›´æ¥ git commit æ·»åŠ  Co-Authored-By
2. Rules Consistency: 5 ä¸ªçŸ›ç›¾/æ¨¡ç³Šä¿®å¤ï¼ˆ1 medium + 4 lowï¼‰

**ä¸‹æ¬¡æ£€æŸ¥**: v2.1.40+ æˆ–æœ‰é‡å¤§åŠŸèƒ½å‘å¸ƒæ—¶ã€‚
