# Config Optimization Report - 2026-02-06

## Version Info

| Field | Value |
|-------|-------|
| Current | 2.1.33 |
| Last Check | 2.1.33 (2026-01-29) |
| New Versions | 2.1.18 → 2.1.33 (16 versions unchecked) |

## New Features (2.1.18 - 2.1.33)

### High Priority - Should Enable

#### 1. `memory` Frontmatter for Skills (v2.1.33)
**Status**: NOT USED
**Impact**: Skills can now persist and recall context across sessions.

```yaml
# In SKILL.md frontmatter
memory: project   # Scopes: user, project, local
```

**Recommendation**: Add `memory: project` to dev-flow skills (commit, plan, ledger) that benefit from session continuity. Add `memory: user` to personal workflow skills.

**Candidate skills**:
- `dev-flow:commit` → `memory: project` (remember commit patterns)
- `dev-flow:create-plan` → `memory: project` (remember architectural decisions)
- `dev-flow:meta-iterate` → `memory: user` (remember improvement patterns)
- `research:research-agent` → `memory: user` (remember research context)

#### 2. `TeammateIdle` and `TaskCompleted` Hook Events (v2.1.33)
**Status**: NOT USED
**Impact**: New hook events for multi-agent coordination.

**Recommendation**: DEFER - These are for the agent teams feature (experimental). Monitor but don't add yet unless actively using `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS`.

#### 3. Agent `tools` Restriction via `Task(agent_type)` (v2.1.33)
**Status**: NOT VERIFIED
**Impact**: Agent frontmatter `tools` field can now restrict subagent types.

**Recommendation**: Audit existing agents to see if any should restrict tool access for safety.

#### 4. PDF `pages` Parameter (v2.1.30)
**Status**: AVAILABLE (built-in)
**Impact**: Read tool now supports `pages: "1-5"` for PDFs.

**Recommendation**: No config change needed - already documented in system prompt. Consider updating research skills to mention this capability.

#### 5. `--from-pr` Session Resumption (v2.1.27)
**Status**: AVAILABLE
**Impact**: Resume sessions linked to a PR number: `claude --from-pr 123`.

**Recommendation**: Document in dev-flow PR workflow. Good for PR review sessions.

#### 6. Content-level Permission Granularity (v2.1.27)
**Status**: NOT CONFIGURED
**Impact**: `allow: ["Bash"], ask: ["Bash(rm *)"]` now properly prompts for destructive commands.

**Recommendation**: Add safety rules for destructive bash patterns:
```json
"permissions": {
  "allow": ["Bash"],
  "ask": ["Bash(rm *)", "Bash(git push --force*)", "Bash(git reset --hard*)"]
}
```

#### 7. `/debug` Command (v2.1.30)
**Status**: AVAILABLE (built-in)
**Impact**: Session troubleshooting tool.

**Recommendation**: No config change needed. Mention in debugging workflows.

### Medium Priority - Consider

#### 8. `spinnerVerbs` Customization (v2.1.23)
**Status**: NOT CONFIGURED
**Impact**: Customize spinner text displayed during operations.

**Recommendation**: Low priority cosmetic change. Skip unless user wants custom spinner text.

#### 9. Skill Budget Scales with Context (v2.1.32)
**Status**: AUTOMATIC
**Impact**: Skill character budget is now 2% of context window (was fixed).

**Recommendation**: No action needed - larger skills are now better handled. Good news for existing skills.

#### 10. Skills in `--add-dir` Auto-load (v2.1.32)
**Status**: AVAILABLE
**Impact**: Skills in additional directories now auto-load.

**Recommendation**: No config change needed unless using `--add-dir`.

### Low Priority - Informational

#### 11. Agent Teams (v2.1.32)
**Status**: EXPERIMENTAL
**Impact**: Multi-agent collaboration feature.

**Recommendation**: DEFER - Requires `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1`. Token-intensive. Monitor.

#### 12. Reduced Motion Mode (v2.1.30)
**Status**: NOT CONFIGURED
**Impact**: Accessibility feature for animations.

**Recommendation**: Skip unless needed.

## Current Config Analysis

### Rules Files: 1683 lines total (active) + 376 lines (backup)
**Observation**: 10 backup files in `.backup/` still consume disk but no tokens. The content from backup files has been consolidated into active rules.

**Recommendation**: Clean up `.backup/` directory if content is fully migrated:
- `command-optimization.md` (88 lines) → merged into `command-tools.md`
- `command-safety.md` (83 lines) → merged into `command-tools.md`
- `capture-discoveries.md` (68 lines) → merged into `agentic-coding.md`
- `short-conversations.md` (67 lines) → merged into `agentic-coding.md`
- Others → verify and clean up

### Hooks
**Current**: 8 hook types configured (PostToolUse, PreCompact, PreToolUse, SessionEnd, SessionStart, Stop, SubagentStop, UserPromptSubmit)

**Missing**: No `Notification` hook, no `PermissionRequest` hook.

**Recommendation**: Consider adding `TaskCompleted` hook when agent teams becomes stable.

### Plugins: 10 enabled
**Observation**: All plugins on latest. `typescript-lsp` pinned to SHA `ee2f726...`.

**Recommendation**: Check if TSP pin is still needed or can be updated.

## Action Items

| # | Action | Priority | Effort |
|---|--------|----------|--------|
| 1 | Add `memory` frontmatter to key skills | HIGH | Low |
| 2 | Add content-level permission for destructive bash | HIGH | Low |
| 3 | Document `--from-pr` in dev-flow PR workflow | MEDIUM | Low |
| 4 | Clean up `.backup/` rules directory | LOW | Low |
| 5 | Update `config-optimize-state.json` checkpoint | HIGH | Trivial |

## State Update

```json
{
  "versions_reviewed": ["2.1.18-2.1.33"],
  "new_optimizations": [
    "memory_frontmatter_for_skills",
    "content_level_permission_granularity",
    "from_pr_session_resumption",
    "pdf_pages_parameter",
    "debug_command"
  ]
}
```
